<Window x:Class="FNEV4.Presentation.Views.GestionFactures.FactureFneDetailsDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:converters="clr-namespace:FNEV4.Presentation.Converters"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        TextElement.FontWeight="Regular"
        TextElement.FontSize="12"
        TextOptions.TextFormattingMode="Ideal"
        TextOptions.TextRenderingMode="Auto"
        Background="{DynamicResource MaterialDesignPaper}"
        FontFamily="{DynamicResource MaterialDesignFont}"
        Title="Facture FNE - Aperçu et Gestion"
        Height="900"
        Width="1400"
        MinHeight="700"
        MinWidth="1200"
        WindowStartupLocation="CenterOwner"
        ShowInTaskbar="False"
        Topmost="False"
        ResizeMode="CanResize">

    <Window.Resources>
        <!-- Converter pour les couleurs TVA -->
        <converters:TvaCodeToBrushConverter x:Key="TvaCodeToBrushConverter"/>
        
        <!-- Converter pour la visibilité des objets null -->
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        
        <!-- Converter personnalisé pour null vers visibilité -->
        <converters:NullToVisibilityConverter x:Key="NullToVisibilityConverter"/>

        <!-- Styles pour facture professionnelle -->
        <Style x:Key="InvoiceHeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="24"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="{DynamicResource PrimaryHueMidBrush}"/>
        </Style>

        <Style x:Key="CompanyNameStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="{DynamicResource MaterialDesignBody}"/>
        </Style>

        <Style x:Key="SectionTitleStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="{DynamicResource PrimaryHueMidBrush}"/>
            <Setter Property="Margin" Value="0,8,0,4"/>
        </Style>

        <Style x:Key="InvoiceFieldLabelStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="{DynamicResource MaterialDesignBodyLight}"/>
            <Setter Property="Margin" Value="0,0,0,2"/>
        </Style>

        <Style x:Key="InvoiceFieldValueStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Foreground" Value="{DynamicResource MaterialDesignBody}"/>
            <Setter Property="Margin" Value="0,0,0,4"/>
        </Style>

        <!-- Style pour les badges de statut -->
        <Style x:Key="StatusBadgeStyle" TargetType="Border">
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="12,6"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>    <!-- Barre d'outils -->
            <RowDefinition Height="*"/>       <!-- Contenu facture -->
        </Grid.RowDefinitions>

        <!-- Barre d'outils contextuelle en haut -->
        <Border Grid.Row="0" 
                Background="{DynamicResource MaterialDesignToolBarBackground}"
                BorderBrush="{DynamicResource MaterialDesignDivider}"
                BorderThickness="0,0,0,1"
                Padding="16,8">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Info facture et statut -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <materialDesign:PackIcon Kind="Receipt" 
                                             Width="24" Height="24"
                                             Foreground="{DynamicResource PrimaryHueMidBrush}"
                                             VerticalAlignment="Center"
                                             Margin="0,0,8,0"/>
                    <TextBlock Text="{Binding FactureTitle}"
                               FontSize="16" FontWeight="SemiBold"
                               VerticalAlignment="Center"
                               Margin="0,0,16,0"/>
                    
                    <!-- Badge de statut -->
                    <Border Style="{StaticResource StatusBadgeStyle}"
                            Background="{Binding StatusBackground}">
                        <TextBlock Text="{Binding StatusText}"
                                   FontSize="12" FontWeight="SemiBold"
                                   Foreground="White"/>
                    </Border>
                </StackPanel>

                <!-- Actions contextuelles -->
                <StackPanel Grid.Column="2" Orientation="Horizontal">
                    <!-- Bouton Certifier (si applicable) -->
                    <Button Content="🏛️ CERTIFIER"
                            Style="{StaticResource MaterialDesignRaisedButton}"
                            Background="{DynamicResource SecondaryHueMidBrush}"
                            Click="CertifierButton_Click"
                            Visibility="{Binding CertifyButtonVisibility}"
                            Margin="0,0,8,0"
                            ToolTip="Certifier cette facture auprès de la DGI"/>

                    <!-- Bouton Imprimer -->
                    <Button Content="🖨️ IMPRIMER"
                            Style="{StaticResource MaterialDesignOutlinedButton}"
                            Margin="0,0,8,0"
                            Click="ImprimerButton_Click"
                            ToolTip="Imprimer cette facture"/>

                    <!-- Menu Plus d'options -->
                    <Button Content="⋮"
                            Style="{StaticResource MaterialDesignIconButton}"
                            ToolTip="Plus d'options">
                        <Button.ContextMenu>
                            <ContextMenu>
                                <MenuItem Header="📄 Télécharger PDF" 
                                          Command="{Binding DownloadPdfCommand}"
                                          IsEnabled="{Binding IsCertified}"/>
                                <MenuItem Header="🔍 Vérifier en ligne" 
                                          Command="{Binding VerifyOnlineCommand}"
                                          IsEnabled="{Binding IsCertified}"/>
                                <MenuItem Header="📋 Copier QR Code" 
                                          Command="{Binding CopyQrDataCommand}"
                                          IsEnabled="{Binding IsCertified}"/>
                                <Separator/>
                                <MenuItem Header="🔍 Détails complets" 
                                          Command="{Binding ShowFullDetailsCommand}"/>
                            </ContextMenu>
                        </Button.ContextMenu>
                    </Button>

                    <!-- Bouton Fermer -->
                    <Button Content="✕" 
                            Style="{StaticResource MaterialDesignIconButton}"
                            Click="CloseButton_Click"
                            ToolTip="Fermer"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Contenu principal - Facture professionnelle -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled"
                      Padding="0" Margin="0">
            <Border Background="White" 
                    BorderBrush="{DynamicResource MaterialDesignDivider}" 
                    BorderThickness="1"
                    CornerRadius="8"
                    Margin="16">
                <Grid Margin="32">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>    <!-- En-tête entreprise -->
                        <RowDefinition Height="Auto"/>    <!-- Informations facture et client -->
                        <RowDefinition Height="Auto"/>    <!-- Articles -->
                        <RowDefinition Height="Auto"/>    <!-- Totaux -->
                        <RowDefinition Height="Auto"/>    <!-- Message commercial et QR -->
                    </Grid.RowDefinitions>

                    <!-- EN-TÊTE ENTREPRISE -->
                    <Grid Grid.Row="0" Margin="0,0,0,32">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="2*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="140"/>   <!-- Colonne pour QR-Code -->
                        </Grid.ColumnDefinitions>

                        <!-- Logo et informations entreprise -->
                        <StackPanel Grid.Column="0">
                            <!-- Espace pour logo entreprise -->
                            <Border Width="120" Height="60" 
                                    Background="{DynamicResource MaterialDesignChipBackground}"
                                    CornerRadius="4"
                                    HorizontalAlignment="Left"
                                    Margin="0,0,0,16">
                                <TextBlock Text="LOGO ENTREPRISE" 
                                           FontSize="10" 
                                           Foreground="{DynamicResource MaterialDesignBodyLight}"
                                           HorizontalAlignment="Center" 
                                           VerticalAlignment="Center"/>
                            </Border>

                            <!-- TODO: Binding avec configuration entreprise -->
                            <TextBlock Text="{Binding CompanyName}" 
                                       Style="{StaticResource CompanyNameStyle}"/>
                            <TextBlock Text="{Binding CompanyAddress}" 
                                       Style="{StaticResource InvoiceFieldValueStyle}"/>
                            <TextBlock Text="{Binding CompanyLocation}" 
                                       Style="{StaticResource InvoiceFieldValueStyle}"/>
                            <TextBlock Text="{Binding CompanyPhone}" 
                                       Style="{StaticResource InvoiceFieldValueStyle}"/>
                            <TextBlock Text="{Binding CompanyEmail}" 
                                       Style="{StaticResource InvoiceFieldValueStyle}"/>
                        </StackPanel>

                        <!-- Numéro de facture et date (mis en évidence) -->
                        <StackPanel Grid.Column="1" HorizontalAlignment="Right">
                            <TextBlock Text="FACTURE" 
                                       Style="{StaticResource InvoiceHeaderStyle}"
                                       HorizontalAlignment="Right"/>
                            
                            <Border Background="{DynamicResource PrimaryHueLightBrush}"
                                    CornerRadius="8"
                                    Padding="16,8"
                                    Margin="0,8,0,16">
                                <StackPanel>
                                    <TextBlock Text="N° FACTURE" 
                                               Style="{StaticResource InvoiceFieldLabelStyle}"
                                               HorizontalAlignment="Center"/>
                                    <TextBlock Text="{Binding Facture.InvoiceNumber}" 
                                               FontSize="16" FontWeight="Bold"
                                               HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>

                            <StackPanel>
                                <TextBlock Text="Date:" Style="{StaticResource InvoiceFieldLabelStyle}"/>
                                <TextBlock Text="{Binding Facture.InvoiceDate, StringFormat='{}{0:dd/MM/yyyy}'}" 
                                           Style="{StaticResource InvoiceFieldValueStyle}"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- QR Code FNE (à droite) -->
                        <StackPanel Grid.Column="2" HorizontalAlignment="Center" VerticalAlignment="Top">
                            <!-- QR Code compact -->
                            <Border Width="120" Height="120" 
                                    Background="{DynamicResource MaterialDesignChipBackground}"
                                    CornerRadius="4"
                                    HorizontalAlignment="Center"
                                    Margin="0,0,0,8"
                                    Visibility="{Binding IsCertified, Converter={StaticResource BooleanToVisibilityConverter}}">
                                <Grid>
                                    <!-- QR Code Image (si disponible) -->
                                    <Image Source="{Binding QrCodeImageSource}"
                                           Width="110" Height="110"
                                           Stretch="Uniform"
                                           Visibility="{Binding QrCodeImageSource, Converter={StaticResource NullToVisibilityConverter}}"/>
                                    
                                    <!-- Placeholder si pas de QR Code -->
                                    <TextBlock Text="QR CODE" 
                                               FontSize="10" 
                                               Foreground="{DynamicResource MaterialDesignBodyLight}"
                                               HorizontalAlignment="Center" 
                                               VerticalAlignment="Center"
                                               Visibility="{Binding QrCodeImageSource, Converter={StaticResource NullToVisibilityConverter}, ConverterParameter=Invert}"/>
                                </Grid>
                            </Border>
                            
                            <!-- Label certificat -->
                            <TextBlock Text="CERTIFIÉ FNE" 
                                       FontSize="10" 
                                       FontWeight="Bold"
                                       Foreground="{DynamicResource PrimaryHueMidBrush}"
                                       HorizontalAlignment="Center"
                                       Visibility="{Binding IsCertified, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                        </StackPanel>
                    </Grid>

                    <!-- INFORMATIONS FACTURE ET CLIENT -->
                    <Grid Grid.Row="1" Margin="0,0,0,24">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Informations client -->
                        <Border Grid.Column="0" 
                                BorderBrush="{DynamicResource MaterialDesignDivider}"
                                BorderThickness="1"
                                CornerRadius="4"
                                Padding="16"
                                Margin="0,0,8,0">
                            <StackPanel>
                                <TextBlock Text="FACTURER À" Style="{StaticResource SectionTitleStyle}"/>
                                <TextBlock Text="{Binding Facture.ClientDisplayName}" 
                                           FontWeight="SemiBold" 
                                           Style="{StaticResource InvoiceFieldValueStyle}"/>
                                <TextBlock Text="{Binding Facture.ClientCode, StringFormat='Code: {0}'}" 
                                           Style="{StaticResource InvoiceFieldValueStyle}"/>
                                <!-- Adresse client si disponible -->
                                <TextBlock Style="{StaticResource InvoiceFieldValueStyle}"
                                           Foreground="{DynamicResource MaterialDesignBodyLight}">
                                    <TextBlock.Text>
                                        <Binding Path="Facture.Client.Address" TargetNullValue="Adresse non renseignée"/>
                                    </TextBlock.Text>
                                </TextBlock>
                                <!-- Téléphone client si disponible -->
                                <TextBlock Style="{StaticResource InvoiceFieldValueStyle}"
                                           Foreground="{DynamicResource MaterialDesignBodyLight}">
                                    <TextBlock.Text>
                                        <Binding Path="Facture.Client.Phone" StringFormat="Tél: {0}" TargetNullValue="Téléphone non renseigné"/>
                                    </TextBlock.Text>
                                </TextBlock>
                                <!-- Email client si disponible -->
                                <TextBlock Style="{StaticResource InvoiceFieldValueStyle}"
                                           Foreground="{DynamicResource MaterialDesignBodyLight}">
                                    <TextBlock.Text>
                                        <Binding Path="Facture.Client.Email" StringFormat="Email: {0}" TargetNullValue="Email non renseigné"/>
                                    </TextBlock.Text>
                                </TextBlock>
                            </StackPanel>
                        </Border>

                        <!-- Informations facture -->
                        <Border Grid.Column="1" 
                                BorderBrush="{DynamicResource MaterialDesignDivider}"
                                BorderThickness="1"
                                CornerRadius="4"
                                Padding="16"
                                Margin="8,0,0,0">
                            <StackPanel>
                                <TextBlock Text="DÉTAILS FACTURE" Style="{StaticResource SectionTitleStyle}"/>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition/>
                                        <RowDefinition/>
                                        <RowDefinition/>
                                        <RowDefinition/>
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Type:" Style="{StaticResource InvoiceFieldLabelStyle}"/>
                                    <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding Facture.InvoiceType}" Style="{StaticResource InvoiceFieldValueStyle}"/>

                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Template:" Style="{StaticResource InvoiceFieldLabelStyle}"/>
                                    <Border Grid.Row="1" Grid.Column="1" 
                                            Background="{Binding TemplateBackground}" 
                                            CornerRadius="3" Padding="4,2" HorizontalAlignment="Left">
                                        <TextBlock Text="{Binding Facture.Template}" 
                                                   Foreground="White" FontSize="9"/>
                                    </Border>

                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Paiement:" Style="{StaticResource InvoiceFieldLabelStyle}"/>
                                    <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding PaymentMethodDisplayName}" Style="{StaticResource InvoiceFieldValueStyle}"/>

                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="Articles:" Style="{StaticResource InvoiceFieldLabelStyle}"/>
                                    <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding NombreArticles}" Style="{StaticResource InvoiceFieldValueStyle}"/>
                                </Grid>
                            </StackPanel>
                        </Border>
                    </Grid>

                    <!-- ARTICLES -->
                    <Border Grid.Row="2" 
                            BorderBrush="{DynamicResource MaterialDesignDivider}"
                            BorderThickness="1"
                            CornerRadius="4"
                            Margin="0,0,0,24">
                        <StackPanel>
                            <!-- En-tête section articles -->
                            <Border Background="{DynamicResource MaterialDesignDivider}"
                                    Padding="16,8"
                                    CornerRadius="4,4,0,0">
                                <Grid>
                                    <TextBlock Text="ARTICLES DE LA FACTURE" 
                                               Style="{StaticResource SectionTitleStyle}"
                                               VerticalAlignment="Center"/>
                                    <TextBlock Text="{Binding NombreArticles, StringFormat='{}{0} article(s)'}"
                                               HorizontalAlignment="Right"
                                               VerticalAlignment="Center"
                                               Style="{StaticResource InvoiceFieldValueStyle}"
                                               Foreground="{DynamicResource MaterialDesignBodyLight}"/>
                                </Grid>
                            </Border>

                            <!-- Table des articles -->
                            <DataGrid ItemsSource="{Binding Articles}" 
                                      AutoGenerateColumns="False"
                                      IsReadOnly="True"
                                      SelectionMode="Single"
                                      CanUserAddRows="False"
                                      CanUserDeleteRows="False"
                                      GridLinesVisibility="Horizontal"
                                      HeadersVisibility="Column"
                                      Background="White"
                                      BorderThickness="0"
                                      Margin="0">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="CODE" 
                                                        Binding="{Binding ProductCode}" 
                                                        Width="100"/>
                                    <DataGridTextColumn Header="DÉSIGNATION" 
                                                        Binding="{Binding Description}" 
                                                        Width="*"/>
                                    <DataGridTextColumn Header="QTÉ" 
                                                        Binding="{Binding Quantity}" 
                                                        Width="80"/>
                                    <DataGridTextColumn Header="PRIX UNIT." 
                                                        Binding="{Binding UnitPrice, StringFormat='{}{0:N0} FCFA'}" 
                                                        Width="120"/>
                                    <DataGridTemplateColumn Header="TVA" Width="100">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Border Background="{Binding VatCode, Converter={StaticResource TvaCodeToBrushConverter}}"
                                                        CornerRadius="2" 
                                                        Padding="4,2">
                                                    <TextBlock Foreground="White" 
                                                               FontWeight="SemiBold"
                                                               FontSize="10"
                                                               HorizontalAlignment="Center">
                                                        <TextBlock.Text>
                                                            <MultiBinding StringFormat="{}{0}-{1:0}%">
                                                                <Binding Path="VatCode"/>
                                                                <Binding Path="VatRate"/>
                                                            </MultiBinding>
                                                        </TextBlock.Text>
                                                    </TextBlock>
                                                </Border>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                    <DataGridTextColumn Header="TOTAL" 
                                                        Binding="{Binding LineAmountTTC, StringFormat='{}{0:N0} FCFA'}" 
                                                        Width="120"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </StackPanel>
                    </Border>

                    <!-- TOTAUX -->
                    <Border Grid.Row="3"
                            BorderBrush="{DynamicResource MaterialDesignDivider}"
                            BorderThickness="1"
                            CornerRadius="4"
                            Margin="0,0,0,24">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Espace pour message commercial -->
                            <StackPanel Grid.Column="0" Margin="16">
                                <TextBlock Text="MESSAGE COMMERCIAL" 
                                           Style="{StaticResource SectionTitleStyle}"
                                           Margin="0,0,0,8"/>
                                <TextBlock Text="Merci de votre confiance. Paiement sous 30 jours."
                                           Style="{StaticResource InvoiceFieldValueStyle}"
                                           TextWrapping="Wrap"
                                           Foreground="{DynamicResource MaterialDesignBodyLight}"/>
                            </StackPanel>

                            <!-- Totaux alignés à droite -->
                            <Border Grid.Column="1" 
                                    Background="{DynamicResource MaterialDesignChipBackground}"
                                    Padding="16"
                                    Margin="8">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition/>
                                        <RowDefinition/>
                                        <RowDefinition/>
                                        <RowDefinition Height="8"/>
                                        <RowDefinition/>
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Sous-total HT:" Style="{StaticResource InvoiceFieldLabelStyle}"/>
                                    <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding Facture.TotalAmountHT, StringFormat='{}{0:N0} FCFA'}" Style="{StaticResource InvoiceFieldValueStyle}"/>

                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="TVA:" Style="{StaticResource InvoiceFieldLabelStyle}"/>
                                    <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding Facture.TotalVatAmount, StringFormat='{}{0:N0} FCFA'}" Style="{StaticResource InvoiceFieldValueStyle}"/>

                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Remise:" Style="{StaticResource InvoiceFieldLabelStyle}"/>
                                    <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding Facture.GlobalDiscount, StringFormat='{}{0:N2}%'}" Style="{StaticResource InvoiceFieldValueStyle}"/>

                                    <Separator Grid.Row="3" Grid.ColumnSpan="2" Margin="0,4"/>

                                    <TextBlock Grid.Row="4" Grid.Column="0" Text="TOTAL TTC:" 
                                               FontWeight="Bold" FontSize="16" 
                                               Foreground="{DynamicResource PrimaryHueMediumBrush}"/>
                                    <TextBlock Grid.Row="4" Grid.Column="1" 
                                               Text="{Binding Facture.TotalAmountTTC, StringFormat='{}{0:N0} FCFA'}"
                                               FontWeight="Bold" FontSize="16" 
                                               Foreground="{DynamicResource PrimaryHueMediumBrush}"/>
                                </Grid>
                            </Border>
                        </Grid>
                    </Border>

                    <!-- MESSAGE COMMERCIAL ET PIED DE PAGE -->
                    <Grid Grid.Row="4">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <!-- Conditions de paiement et mentions légales -->
                        <StackPanel Grid.Column="0">
                            <TextBlock Text="CONDITIONS DE RÈGLEMENT"
                                       Style="{StaticResource InvoiceFieldLabelStyle}"
                                       Margin="0,0,0,4"/>
                            <TextBlock Text="Paiement sous 30 jours. Pénalités de retard applicables."
                                       Style="{StaticResource InvoiceFieldValueStyle}"
                                       Foreground="{DynamicResource MaterialDesignBodyLight}"
                                       FontSize="10"/>
                        </StackPanel>

                        <!-- Code-barres / références -->
                        <Border Grid.Column="1" 
                                Width="200" Height="40"
                                Background="{DynamicResource MaterialDesignChipBackground}"
                                CornerRadius="4"
                                Margin="16,0,0,0">
                            <TextBlock Text="CODE-BARRES FACTURE" 
                                       FontSize="10" 
                                       Foreground="{DynamicResource MaterialDesignBodyLight}"
                                       HorizontalAlignment="Center" 
                                       VerticalAlignment="Center"/>
                        </Border>
                    </Grid>
                </Grid>
            </Border>
        </ScrollViewer>
    </Grid>
</Window>