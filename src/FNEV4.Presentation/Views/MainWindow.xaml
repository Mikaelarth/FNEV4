<Window x:Class="FNEV4.Presentation.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:viewModels="clr-namespace:FNEV4.Presentation.ViewModels"
        xmlns:converters="clr-namespace:FNEV4.Presentation.Converters"
        Title="{Binding ApplicationTitle}"
        Height="800" Width="1200"
        MinHeight="600" MinWidth="900"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized"
        Background="{DynamicResource MaterialDesignPaper}"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        TextElement.FontWeight="Regular"
        TextElement.FontSize="13"
        TextOptions.TextFormattingMode="Ideal"
        TextOptions.TextRenderingMode="Auto"
        FontFamily="{DynamicResource MaterialDesignFont}">

    <Window.Resources>
        <converters:BooleanToGridLengthConverter x:Key="BooleanToGridLengthConverter" />
        <converters:MenuVisibilityConverter x:Key="MenuVisibilityConverter" />
    </Window.Resources>

    <Window.DataContext>
        <viewModels:MainViewModel />
    </Window.DataContext>

    <!-- Layout principal -->
    <Grid>
        <Grid.RowDefinitions>
            <!-- Barre de titre -->
            <RowDefinition Height="64" />
            <!-- Contenu principal -->
            <RowDefinition Height="*" />
            <!-- Barre de statut -->
            <RowDefinition Height="32" />
        </Grid.RowDefinitions>

        <!-- BARRE DE TITRE -->
        <materialDesign:Card Grid.Row="0"
                           materialDesign:ShadowAssist.ShadowDepth="Depth1"
                           Margin="0">
            <Grid Background="{DynamicResource PrimaryHueMidBrush}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <!-- Bouton menu + Logo -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <Button Style="{StaticResource MaterialDesignIconButton}"
                            Command="{Binding ToggleMenuCommand}"
                            Foreground="White"
                            Margin="16,0,8,0">
                        <materialDesign:PackIcon Kind="Menu" Width="24" Height="24" />
                    </Button>
                    
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="8,0">
                        <materialDesign:PackIcon Kind="Receipt" 
                                               Width="32" Height="32" 
                                               Foreground="White"
                                               VerticalAlignment="Center" />
                        <TextBlock Text="FNEV4" 
                                 FontSize="20" 
                                 FontWeight="Bold" 
                                 Foreground="White" 
                                 VerticalAlignment="Center" 
                                 Margin="12,0,0,0" />
                    </StackPanel>
                </StackPanel>

                <!-- Titre du module actuel -->
                <TextBlock Grid.Column="1"
                         Text="{Binding CurrentModuleName}"
                         FontSize="18"
                         FontWeight="Medium"
                         Foreground="White"
                         VerticalAlignment="Center"
                         HorizontalAlignment="Center" />

                <!-- Zone utilisateur et paramètres -->
                <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,16,0">
                    <!-- Informations connexion -->
                    <StackPanel Orientation="Horizontal" Margin="0,0,16,0">
                        <materialDesign:PackIcon Kind="CloudCheck" 
                                               Width="20" Height="20" 
                                               Foreground="White" 
                                               VerticalAlignment="Center" />
                        <TextBlock Text="{Binding ConnectionStatus}" 
                                 FontSize="12" 
                                 Foreground="White" 
                                 VerticalAlignment="Center" 
                                 Margin="4,0,0,0" />
                    </StackPanel>

                    <!-- Balance stickers -->
                    <StackPanel Orientation="Horizontal" Margin="0,0,16,0">
                        <materialDesign:PackIcon Kind="Tag" 
                                               Width="20" Height="20" 
                                               Foreground="White" 
                                               VerticalAlignment="Center" />
                        <TextBlock Text="{Binding StickerBalance, StringFormat='{}{0} stickers'}" 
                                 FontSize="12" 
                                 Foreground="White" 
                                 VerticalAlignment="Center" 
                                 Margin="4,0,0,0" />
                    </StackPanel>

                    <!-- Bouton paramètres -->
                    <Button Style="{StaticResource MaterialDesignIconButton}"
                            Command="{Binding NavigateToConfigurationCommand}"
                            Foreground="White">
                        <materialDesign:PackIcon Kind="Settings" Width="20" Height="20" />
                    </Button>
                </StackPanel>
            </Grid>
        </materialDesign:Card>

        <!-- CONTENU PRINCIPAL -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <!-- Menu navigation -->
                <ColumnDefinition Width="{Binding IsMenuExpanded, Converter={StaticResource BooleanToGridLengthConverter}, ConverterParameter='280,56'}" />
                <!-- Zone de contenu -->
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <!-- MENU DE NAVIGATION -->
            <materialDesign:Card Grid.Column="0"
                               materialDesign:ShadowAssist.ShadowDepth="Depth1"
                               Margin="0">
                <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Hidden">
                    <StackPanel Margin="8,16">
                        
                        <!-- MODULE 1: DASHBOARD -->
                        <Border x:Name="DashboardSection" Margin="0,4">
                            <!-- Header du module -->
                            <Button Style="{StaticResource MaterialDesignFlatButton}"
                                    Background="Transparent"
                                    HorizontalContentAlignment="Left"
                                    Height="48"
                                    Padding="8,0"
                                    Click="ToggleDashboardSection">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="40" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    
                                    <materialDesign:PackIcon Grid.Column="0" 
                                                           Kind="ViewDashboard" 
                                                           Width="24" Height="24"
                                                           VerticalAlignment="Center"
                                                           HorizontalAlignment="Center" />
                                                           
                                    <TextBlock Grid.Column="1" 
                                             Text="Tableau de Bord"
                                             VerticalAlignment="Center"
                                             Margin="8,0,0,0"
                                             FontSize="14"
                                             FontWeight="Medium"
                                             Foreground="{DynamicResource MaterialDesignBody}"
                                             Visibility="{Binding IsMenuExpanded, Converter={StaticResource BooleanToVisibilityConverter}}" />
                                             
                                    <materialDesign:PackIcon Grid.Column="2" 
                                                           Kind="ChevronDown" 
                                                           Width="16" Height="16"
                                                           VerticalAlignment="Center"
                                                           x:Name="DashboardChevron"
                                                           Visibility="{Binding IsMenuExpanded, Converter={StaticResource BooleanToVisibilityConverter}}" />
                                </Grid>
                            </Button>
                        </Border>
                        
                        <!-- Sous-menu Dashboard (visible seulement si menu étendu ET section ouverte) -->
                        <StackPanel x:Name="DashboardSubMenu" 
                                  Margin="48,0,0,8" 
                                  Visibility="Collapsed">
                            <Button Style="{StaticResource MaterialDesignFlatButton}"
                                    Command="{Binding NavigateToDashboardCommand}"
                                    HorizontalContentAlignment="Left"
                                    Height="36"
                                    Content="Vue d'ensemble" />
                            <Button Style="{StaticResource MaterialDesignFlatButton}"
                                    Command="{Binding NavigateToDashboardStatusCommand}"
                                    HorizontalContentAlignment="Left"
                                    Height="36"
                                    Content="Statut du système" />
                            <Button Style="{StaticResource MaterialDesignFlatButton}"
                                    Command="{Binding NavigateToDashboardActionsCommand}"
                                    HorizontalContentAlignment="Left"
                                    Height="36"
                                    Content="Actions rapides" />
                        </StackPanel>

                        <!-- MODULE 2: IMPORT & TRAITEMENT -->
                        <Border x:Name="ImportSection" Margin="0,4">
                            <!-- Header du module -->
                            <Button Style="{StaticResource MenuSectionButton}"
                                    Click="ToggleImportSection"
                                    HorizontalContentAlignment="Left"
                                    Height="48"
                                    Padding="8,0"
                                    ToolTip="Import &amp; Traitement">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="40" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    
                                    <materialDesign:PackIcon Grid.Column="0" 
                                                           Kind="Import" 
                                                           Width="24" Height="24"
                                                           VerticalAlignment="Center"
                                                           HorizontalAlignment="Center" />
                                                           
                                    <TextBlock Grid.Column="1" 
                                             Text="Import &amp; Traitement"
                                             VerticalAlignment="Center"
                                             Margin="8,0,0,0"
                                             FontSize="14"
                                             FontWeight="Medium"
                                             Foreground="{DynamicResource MaterialDesignBody}"
                                             Visibility="{Binding IsMenuExpanded, Converter={StaticResource BooleanToVisibilityConverter}}" />
                                             
                                    <materialDesign:PackIcon Grid.Column="2" 
                                                           Kind="ChevronDown" 
                                                           Width="16" Height="16"
                                                           VerticalAlignment="Center"
                                                           x:Name="ImportChevron"
                                                           Visibility="{Binding IsMenuExpanded, Converter={StaticResource BooleanToVisibilityConverter}}" />
                                </Grid>
                            </Button>
                        </Border>
                        
                        <!-- Sous-menu Import (visible seulement si menu étendu ET section ouverte) -->
                        <StackPanel x:Name="ImportSubMenu" 
                                  Margin="48,0,0,8" 
                                  Visibility="Collapsed">
                            <Button Style="{StaticResource MenuSubItemButton}"
                                    Command="{Binding NavigateToImportFichiersCommand}"
                                    HorizontalContentAlignment="Left"
                                    Height="36"
                                    Content="Import de fichiers" />
                            <Button Style="{StaticResource MenuSubItemButton}"
                                    Command="{Binding NavigateToParsingValidationCommand}"
                                    HorizontalContentAlignment="Left"
                                    Height="36"
                                    Content="Parsing &amp; Validation" />
                            <Button Style="{StaticResource MenuSubItemButton}"
                                    Command="{Binding NavigateToHistoriqueImportsCommand}"
                                    HorizontalContentAlignment="Left"
                                    Height="36"
                                    Content="Historique des imports" />
                        </StackPanel>

                        <!-- MODULE 3: GESTION DES FACTURES -->
                        <Border x:Name="FacturesSection" Margin="0,4">
                            <!-- Header du module -->
                            <Button Style="{StaticResource MenuSectionButton}"
                                    Click="ToggleFacturesSection"
                                    HorizontalContentAlignment="Left"
                                    Height="48"
                                    Padding="8,0"
                                    ToolTip="Gestion des Factures">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="40" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    
                                    <materialDesign:PackIcon Grid.Column="0" 
                                                           Kind="Receipt" 
                                                           Width="24" Height="24"
                                                           VerticalAlignment="Center"
                                                           HorizontalAlignment="Center" />
                                                           
                                    <TextBlock Grid.Column="1" 
                                             Text="Gestion des Factures"
                                             VerticalAlignment="Center"
                                             Margin="8,0,0,0"
                                             FontSize="14"
                                             FontWeight="Medium"
                                             Foreground="{DynamicResource MaterialDesignBody}"
                                             Visibility="{Binding IsMenuExpanded, Converter={StaticResource BooleanToVisibilityConverter}}" />
                                             
                                    <materialDesign:PackIcon Grid.Column="2" 
                                                           Kind="ChevronDown" 
                                                           Width="16" Height="16"
                                                           VerticalAlignment="Center"
                                                           x:Name="FacturesChevron"
                                                           Visibility="{Binding IsMenuExpanded, Converter={StaticResource BooleanToVisibilityConverter}}" />
                                </Grid>
                            </Button>
                        </Border>
                        
                        <!-- Sous-menu Factures -->
                        <StackPanel x:Name="FacturesSubMenu" 
                                  Margin="48,0,0,8" 
                                  Visibility="Collapsed">
                            <Button Style="{StaticResource MenuSubItemButton}"
                                    Command="{Binding NavigateToListeFacturesCommand}"
                                    HorizontalContentAlignment="Left"
                                    Height="36"
                                    Content="Liste des factures" />
                            <Button Style="{StaticResource MenuSubItemButton}"
                                    Command="{Binding NavigateToEditionFacturesCommand}"
                                    HorizontalContentAlignment="Left"
                                    Height="36"
                                    Content="Édition de factures" />
                            <Button Style="{StaticResource MenuSubItemButton}"
                                    Command="{Binding NavigateToDetailsFactureCommand}"
                                    HorizontalContentAlignment="Left"
                                    Height="36"
                                    Content="Détails de facture" />
                            <Button Style="{StaticResource MenuSubItemButton}"
                                    Command="{Binding NavigateToFacturesAvoirCommand}"
                                    HorizontalContentAlignment="Left"
                                    Height="36"
                                    Content="Factures d'avoir" />
                        </StackPanel>

                        <!-- MODULE 4: CERTIFICATION FNE -->
                        <Border x:Name="CertificationSection" Margin="0,4">
                            <Button Style="{StaticResource MenuSectionButton}"
                                    Click="ToggleCertificationSection"
                                    ToolTip="Certification FNE">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="40" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <materialDesign:PackIcon Grid.Column="0" Kind="Certificate" 
                                                           Width="24" Height="24"
                                                           VerticalAlignment="Center"
                                                           HorizontalAlignment="Center" />
                                    <TextBlock Grid.Column="1" Text="Certification FNE"
                                             VerticalAlignment="Center" Margin="8,0,0,0"
                                             FontSize="14" FontWeight="Medium"
                                             Foreground="{DynamicResource MaterialDesignBody}"
                                             Visibility="{Binding IsMenuExpanded, Converter={StaticResource BooleanToVisibilityConverter}}" />
                                    <materialDesign:PackIcon Grid.Column="2" 
                                                           Kind="ChevronDown" 
                                                           Width="16" Height="16"
                                                           VerticalAlignment="Center"
                                                           x:Name="CertificationChevron"
                                                           Visibility="{Binding IsMenuExpanded, Converter={StaticResource BooleanToVisibilityConverter}}" />
                                </Grid>
                            </Button>
                        </Border>
                        
                        <!-- Sous-menu Certification -->
                        <StackPanel x:Name="CertificationSubMenu" 
                                  Margin="48,0,0,8" 
                                  Visibility="Collapsed">
                            <Button Style="{StaticResource MenuSubItemButton}"
                                    Command="{Binding NavigateToCertificationManuelleCommand}"
                                    Content="Certification manuelle" />
                            <Button Style="{StaticResource MenuSubItemButton}"
                                    Command="{Binding NavigateToCertificationAutomatiqueCommand}"
                                    Content="Certification automatique" />
                            <Button Style="{StaticResource MenuSubItemButton}"
                                    Command="{Binding NavigateToSuiviCertificationsCommand}"
                                    Content="Suivi des certifications" />
                            <Button Style="{StaticResource MenuSubItemButton}"
                                    Command="{Binding NavigateToRetryReprisesCommand}"
                                    Content="Retry &amp; Reprises" />
                        </StackPanel>

                        <!-- MODULE 5: GESTION CLIENTS -->
                        <Border x:Name="ClientsSection" Margin="0,4">
                            <Button Style="{StaticResource MenuSectionButton}"
                                    Click="ToggleClientsSection"
                                    ToolTip="Gestion Clients">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="40" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <materialDesign:PackIcon Grid.Column="0" Kind="AccountGroup" 
                                                           Width="24" Height="24"
                                                           VerticalAlignment="Center"
                                                           HorizontalAlignment="Center" />
                                    <TextBlock Grid.Column="1" Text="Gestion Clients"
                                             VerticalAlignment="Center" Margin="8,0,0,0"
                                             FontSize="14" FontWeight="Medium"
                                             Foreground="{DynamicResource MaterialDesignBody}"
                                             Visibility="{Binding IsMenuExpanded, Converter={StaticResource BooleanToVisibilityConverter}}" />
                                    <materialDesign:PackIcon Grid.Column="2" 
                                                           Kind="ChevronDown" 
                                                           Width="16" Height="16"
                                                           VerticalAlignment="Center"
                                                           x:Name="ClientsChevron"
                                                           Visibility="{Binding IsMenuExpanded, Converter={StaticResource BooleanToVisibilityConverter}}" />
                                </Grid>
                            </Button>
                        </Border>
                        
                        <!-- Sous-menu Clients -->
                        <StackPanel x:Name="ClientsSubMenu" 
                                  Margin="48,0,0,8" 
                                  Visibility="Collapsed">
                            <Button Style="{StaticResource MenuSubItemButton}"
                                    Command="{Binding NavigateToListeClientsCommand}"
                                    Content="Liste des clients" />
                            <Button Style="{StaticResource MenuSubItemButton}"
                                    Command="{Binding NavigateToAjoutModificationClientCommand}"
                                    Content="Ajout/Modification" />
                            <Button Style="{StaticResource MenuSubItemButton}"
                                    Command="{Binding NavigateToRechercheAvanceeCommand}"
                                    Content="Recherche avancée" />
                        </StackPanel>

                        <!-- MODULE 6: RAPPORTS & ANALYSES -->
                        <Border x:Name="RapportsSection" Margin="0,4">
                            <Button Style="{StaticResource MenuSectionButton}"
                                    Click="ToggleRapportsSection"
                                    ToolTip="Rapports &amp; Analyses">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="40" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <materialDesign:PackIcon Grid.Column="0" Kind="ChartLine" 
                                                           Width="24" Height="24"
                                                           VerticalAlignment="Center"
                                                           HorizontalAlignment="Center" />
                                    <TextBlock Grid.Column="1" Text="Rapports &amp; Analyses"
                                             VerticalAlignment="Center" Margin="8,0,0,0"
                                             FontSize="14" FontWeight="Medium"
                                             Foreground="{DynamicResource MaterialDesignBody}"
                                             Visibility="{Binding IsMenuExpanded, Converter={StaticResource BooleanToVisibilityConverter}}" />
                                    <materialDesign:PackIcon Grid.Column="2" 
                                                           Kind="ChevronDown" 
                                                           Width="16" Height="16"
                                                           VerticalAlignment="Center"
                                                           x:Name="RapportsChevron"
                                                           Visibility="{Binding IsMenuExpanded, Converter={StaticResource BooleanToVisibilityConverter}}" />
                                </Grid>
                            </Button>
                        </Border>
                        
                        <!-- Sous-menu Rapports -->
                        <StackPanel x:Name="RapportsSubMenu" 
                                  Margin="48,0,0,8" 
                                  Visibility="Collapsed">
                            <Button Style="{StaticResource MenuSubItemButton}"
                                    Command="{Binding NavigateToRapportsStandardsCommand}"
                                    Content="Rapports standards" />
                            <Button Style="{StaticResource MenuSubItemButton}"
                                    Command="{Binding NavigateToRapportsFneCommand}"
                                    Content="Rapports FNE" />
                            <Button Style="{StaticResource MenuSubItemButton}"
                                    Command="{Binding NavigateToAnalysesPersonnaliseesCommand}"
                                    Content="Analyses personnalisées" />
                        </StackPanel>

                        <!-- SÉPARATEUR -->
                        <Separator Margin="8,16" Background="{DynamicResource MaterialDesignDivider}" 
                                 Visibility="{Binding IsMenuExpanded, Converter={StaticResource BooleanToVisibilityConverter}}" />

                        <!-- MODULE 7: CONFIGURATION -->
                        <Border x:Name="ConfigurationSection" Margin="0,4">
                            <Button Style="{StaticResource MenuSectionButton}"
                                    Click="ToggleConfigurationSection"
                                    ToolTip="Configuration">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="40" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <materialDesign:PackIcon Grid.Column="0" Kind="Settings" 
                                                           Width="24" Height="24"
                                                           VerticalAlignment="Center"
                                                           HorizontalAlignment="Center" />
                                    <TextBlock Grid.Column="1" Text="Configuration"
                                             VerticalAlignment="Center" Margin="8,0,0,0"
                                             FontSize="14" FontWeight="Medium"
                                             Foreground="{DynamicResource MaterialDesignBody}"
                                             Visibility="{Binding IsMenuExpanded, Converter={StaticResource BooleanToVisibilityConverter}}" />
                                    <materialDesign:PackIcon Grid.Column="2" 
                                                           Kind="ChevronDown" 
                                                           Width="16" Height="16"
                                                           VerticalAlignment="Center"
                                                           x:Name="ConfigurationChevron"
                                                           Visibility="{Binding IsMenuExpanded, Converter={StaticResource BooleanToVisibilityConverter}}" />
                                </Grid>
                            </Button>
                        </Border>
                        
                        <!-- Sous-menu Configuration -->
                        <StackPanel x:Name="ConfigurationSubMenu" 
                                  Margin="48,0,0,8" 
                                  Visibility="Collapsed">
                            <Button Style="{StaticResource MenuSubItemButton}"
                                    Command="{Binding NavigateToEntrepriseConfigCommand}"
                                    Content="Entreprise" />
                            <Button Style="{StaticResource MenuSubItemButton}"
                                    Command="{Binding NavigateToApiFneConfigCommand}"
                                    Content="API FNE" />
                            <Button Style="{StaticResource MenuSubItemButton}"
                                    Command="{Binding NavigateToCheminsDossiersCommand}"
                                    Content="Chemins &amp; Dossiers" />
                            <Button Style="{StaticResource MenuSubItemButton}"
                                    Command="{Binding NavigateToInterfaceUtilisateurCommand}"
                                    Content="Interface utilisateur" />
                            <Button Style="{StaticResource MenuSubItemButton}"
                                    Command="{Binding NavigateToPerformancesCommand}"
                                    Content="Performances" />
                        </StackPanel>

                        <!-- MODULE 8: MAINTENANCE -->
                        <Border x:Name="MaintenanceSection" Margin="0,4">
                            <StackPanel>
                                <!-- En-tête section Maintenance -->
                                <Button Style="{StaticResource MenuSectionButton}"
                                        Click="ToggleMaintenanceSection"
                                        ToolTip="Maintenance">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="40" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="24" />
                                        </Grid.ColumnDefinitions>
                                        <materialDesign:PackIcon Grid.Column="0" Kind="Tools" 
                                                               Width="24" Height="24"
                                                               VerticalAlignment="Center"
                                                               HorizontalAlignment="Center" />
                                        <TextBlock Grid.Column="1" Text="Maintenance"
                                                 VerticalAlignment="Center" Margin="8,0,0,0"
                                                 FontSize="14" FontWeight="Medium"
                                                 Foreground="{DynamicResource MaterialDesignBody}"
                                                 Visibility="{Binding IsMenuExpanded, Converter={StaticResource BooleanToVisibilityConverter}}" />
                                        <materialDesign:PackIcon Grid.Column="2" Kind="ChevronDown" x:Name="MaintenanceChevron"
                                                               Width="16" Height="16"
                                                               VerticalAlignment="Center"
                                                               HorizontalAlignment="Center"
                                                               Visibility="{Binding IsMenuExpanded, Converter={StaticResource BooleanToVisibilityConverter}}" />
                                    </Grid>
                                </Button>

                                <!-- Sous-menus Maintenance -->
                                <StackPanel x:Name="MaintenanceSubMenu" Visibility="Collapsed"
                                          Margin="16,0,0,0">
                                    <!-- Logs & Diagnostics -->
                                    <Button Style="{StaticResource MenuSubItemButton}"
                                            Command="{Binding NavigateToLogsDiagnosticsCommand}"
                                            Margin="0,2">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="24" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <materialDesign:PackIcon Grid.Column="0" Kind="FileDocumentOutline" 
                                                                   Width="16" Height="16"
                                                                   VerticalAlignment="Center"
                                                                   HorizontalAlignment="Center" />
                                            <TextBlock Grid.Column="1" Text="Logs &amp; Diagnostics"
                                                     VerticalAlignment="Center" Margin="8,0,0,0"
                                                     FontSize="13"
                                                     Foreground="{DynamicResource MaterialDesignBodyLight}"
                                                     Visibility="{Binding IsMenuExpanded, Converter={StaticResource BooleanToVisibilityConverter}}" />
                                        </Grid>
                                    </Button>

                                    <!-- Base de données -->
                                    <Button Style="{StaticResource MenuSubItemButton}"
                                            Command="{Binding NavigateToBaseDonneesCommand}"
                                            Margin="0,2">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="24" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <materialDesign:PackIcon Grid.Column="0" Kind="Database" 
                                                                   Width="16" Height="16"
                                                                   VerticalAlignment="Center"
                                                                   HorizontalAlignment="Center" />
                                            <TextBlock Grid.Column="1" Text="Base de données"
                                                     VerticalAlignment="Center" Margin="8,0,0,0"
                                                     FontSize="13"
                                                     Foreground="{DynamicResource MaterialDesignBodyLight}"
                                                     Visibility="{Binding IsMenuExpanded, Converter={StaticResource BooleanToVisibilityConverter}}" />
                                        </Grid>
                                    </Button>

                                    <!-- Synchronisation -->
                                    <Button Style="{StaticResource MenuSubItemButton}"
                                            Command="{Binding NavigateToSynchronisationCommand}"
                                            Margin="0,2">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="24" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <materialDesign:PackIcon Grid.Column="0" Kind="Sync" 
                                                                   Width="16" Height="16"
                                                                   VerticalAlignment="Center"
                                                                   HorizontalAlignment="Center" />
                                            <TextBlock Grid.Column="1" Text="Synchronisation"
                                                     VerticalAlignment="Center" Margin="8,0,0,0"
                                                     FontSize="13"
                                                     Foreground="{DynamicResource MaterialDesignBodyLight}"
                                                     Visibility="{Binding IsMenuExpanded, Converter={StaticResource BooleanToVisibilityConverter}}" />
                                        </Grid>
                                    </Button>

                                    <!-- Outils techniques -->
                                    <Button Style="{StaticResource MenuSubItemButton}"
                                            Command="{Binding NavigateToOutilsTechniquesCommand}"
                                            Margin="0,2">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="24" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <materialDesign:PackIcon Grid.Column="0" Kind="Wrench" 
                                                                   Width="16" Height="16"
                                                                   VerticalAlignment="Center"
                                                                   HorizontalAlignment="Center" />
                                            <TextBlock Grid.Column="1" Text="Outils techniques"
                                                     VerticalAlignment="Center" Margin="8,0,0,0"
                                                     FontSize="13"
                                                     Foreground="{DynamicResource MaterialDesignBodyLight}"
                                                     Visibility="{Binding IsMenuExpanded, Converter={StaticResource BooleanToVisibilityConverter}}" />
                                        </Grid>
                                    </Button>
                                </StackPanel>
                            </StackPanel>
                        </Border>

                        <!-- MODULE 9: AIDE & SUPPORT -->
                        <Border x:Name="AideSection" Margin="0,4">
                            <Button Style="{StaticResource MenuSectionButton}"
                                    Command="{Binding NavigateToDocumentationCommand}"
                                    ToolTip="Aide &amp; Support">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="40" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <materialDesign:PackIcon Grid.Column="0" Kind="HelpCircle" 
                                                           Width="24" Height="24"
                                                           VerticalAlignment="Center"
                                                           HorizontalAlignment="Center" />
                                    <TextBlock Grid.Column="1" Text="Aide &amp; Support"
                                             VerticalAlignment="Center" Margin="8,0,0,0"
                                             FontSize="14" FontWeight="Medium"
                                             Foreground="{DynamicResource MaterialDesignBody}"
                                             Visibility="{Binding IsMenuExpanded, Converter={StaticResource BooleanToVisibilityConverter}}" />
                                </Grid>
                            </Button>
                        </Border>

                    </StackPanel>
                </ScrollViewer>
            </materialDesign:Card>

            <!-- ZONE DE CONTENU PRINCIPAL -->
            <Grid Grid.Column="1" Background="{DynamicResource MaterialDesignBackground}">
                <!-- Zone de contenu dynamique -->
                <Border Margin="0" Background="{DynamicResource MaterialDesignPaper}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <!-- En-tête du module actuel -->
                        <Border Grid.Row="0" 
                                Background="{DynamicResource MaterialDesignToolBarBackground}"
                                BorderBrush="{DynamicResource MaterialDesignDivider}"
                                BorderThickness="0,0,0,1"
                                Padding="24,16">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <TextBlock Grid.Column="0"
                                         Text="{Binding CurrentModuleName}"
                                         FontSize="20"
                                         FontWeight="Medium"
                                         Foreground="{DynamicResource MaterialDesignBody}"
                                         VerticalAlignment="Center"/>
                                         
                                <TextBlock Grid.Column="1"
                                         Text="{Binding ApplicationVersion}"
                                         FontSize="12"
                                         Foreground="{DynamicResource MaterialDesignBodyLight}"
                                         VerticalAlignment="Center"/>
                            </Grid>
                        </Border>
                        
                        <!-- Contenu du module -->
                        <ContentPresenter Grid.Row="1" 
                                        Content="{Binding CurrentView}"
                                        Margin="0"/>
                    </Grid>
                </Border>
            </Grid>

        </Grid>

        <!-- BARRE DE STATUT -->
        <Border Grid.Row="2" 
                Background="{DynamicResource MaterialDesignCardBackground}"
                BorderBrush="{DynamicResource MaterialDesignDivider}"
                BorderThickness="0,1,0,0">
            <Grid Margin="16,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0" 
                         Text="{Binding CompanyName, StringFormat='Entreprise: {0}'}"
                         VerticalAlignment="Center"
                         FontSize="12"
                         Foreground="{DynamicResource MaterialDesignBodyLight}" />

                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <TextBlock Text="{Binding ApplicationVersion}"
                             VerticalAlignment="Center"
                             FontSize="12"
                             Foreground="{DynamicResource MaterialDesignBodyLight}"
                             Margin="0,0,16,0" />
                    
                    <Button Style="{StaticResource MaterialDesignToolButton}"
                            Command="{Binding RefreshConnectionStatusCommand}"
                            ToolTip="Actualiser l'état de connexion">
                        <materialDesign:PackIcon Kind="Refresh" Width="12" Height="12" />
                    </Button>
                </StackPanel>
            </Grid>
        </Border>

    </Grid>
</Window>
