<UserControl x:Class="FNEV4.Presentation.Views.Maintenance.LogsDiagnosticsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:converters="clr-namespace:FNEV4.Presentation.Converters"
             x:Name="LogsDiagnosticsUserControl">
    
    <UserControl.Resources>
        <!-- Convertisseurs pour les bindings -->
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        <converters:StringToVisibilityConverter x:Key="StringToVisibilityConverter"/>
        
        <!-- Style pour les cartes de diagnostic -->
        <Style x:Key="DiagnosticCardStyle" TargetType="materialDesign:Card">
            <Setter Property="Padding" Value="16"/>
            <Setter Property="Margin" Value="4"/>
            <Setter Property="materialDesign:ElevationAssist.Elevation" Value="Dp2"/>
            <Setter Property="Background" Value="{DynamicResource MaterialDesignCardBackground}"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="{DynamicResource MaterialDesignShadow}" 
                                    Direction="270" BlurRadius="8" ShadowDepth="2" Opacity="0.3"/>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="materialDesign:ElevationAssist.Elevation" Value="Dp4"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Style pour les cartes de logs -->
        <Style x:Key="LogsCardStyle" TargetType="materialDesign:Card">
            <Setter Property="Margin" Value="0,8"/>
            <Setter Property="materialDesign:ElevationAssist.Elevation" Value="Dp2"/>
            <Setter Property="Background" Value="{DynamicResource MaterialDesignCardBackground}"/>
        </Style>

        <!-- Style pour les boutons d'action -->
        <Style x:Key="ActionButtonStyle" TargetType="Button" BasedOn="{StaticResource MaterialDesignRaisedButton}">
            <Setter Property="MinWidth" Value="120"/>
            <Setter Property="Height" Value="36"/>
            <Setter Property="Margin" Value="8,0,0,0"/>
            <Setter Property="FontWeight" Value="Medium"/>
        </Style>
        
        <!-- Style pour les boutons secondaires -->
        <Style x:Key="SecondaryButtonStyle" TargetType="Button" BasedOn="{StaticResource MaterialDesignOutlinedButton}">
            <Setter Property="MinWidth" Value="120"/>
            <Setter Property="Height" Value="36"/>
            <Setter Property="Margin" Value="8,0,0,0"/>
        </Style>

        <!-- Animations pour les entrées -->
        <Storyboard x:Key="FadeInAnimation">
            <DoubleAnimation Storyboard.TargetProperty="Opacity" From="0" To="1" Duration="0:0:0.3"/>
            <ThicknessAnimation Storyboard.TargetProperty="Margin" From="0,10,0,0" To="0,0,0,0" Duration="0:0:0.3"/>
        </Storyboard>
    </UserControl.Resources>

    <Grid Margin="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- En-tête avec design moderne -->
        <materialDesign:Card Grid.Row="0" Style="{StaticResource LogsCardStyle}" Padding="0" Margin="0,0,0,16">
            <Border CornerRadius="4,4,0,0">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                        <GradientStop Color="{DynamicResource Primary500}" Offset="0"/>
                        <GradientStop Color="{DynamicResource Primary700}" Offset="1"/>
                    </LinearGradientBrush>
                </Border.Background>
                <Grid Margin="24,20">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <materialDesign:PackIcon Grid.Column="0" Kind="FileTextOutline" Width="32" Height="32" 
                                           Foreground="White" VerticalAlignment="Center" Margin="0,0,16,0"/>
                    
                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                        <TextBlock Text="Logs &amp; Diagnostics" FontSize="24" FontWeight="Bold" 
                                 Foreground="White"/>
                        <TextBlock Text="Surveillance en temps réel et diagnostic du système" 
                                 FontSize="14" Opacity="0.8" Foreground="White" Margin="0,4,0,0"/>
                    </StackPanel>
                    
                    <materialDesign:PackIcon Grid.Column="2" Kind="Pulse" Width="24" Height="24" 
                                           Foreground="White" VerticalAlignment="Center" Opacity="0.7"/>
                </Grid>
            </Border>
        </materialDesign:Card>

        <!-- Tableau de bord et contrôles -->
        <materialDesign:Card Grid.Row="1" Style="{StaticResource LogsCardStyle}" Padding="24">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <!-- Statistiques en temps réel -->
                <UniformGrid Grid.Row="0" Columns="4" Margin="0,0,0,24">
                    <!-- État du système -->
                    <materialDesign:Card Style="{StaticResource DiagnosticCardStyle}">
                        <StackPanel HorizontalAlignment="Center">
                            <materialDesign:PackIcon Kind="CheckCircle" Width="32" Height="32" 
                                                   Foreground="{DynamicResource MaterialDesignValidationSuccessBrush}" 
                                                   Margin="0,0,0,8"/>
                            <TextBlock Text="Opérationnel" FontWeight="Bold" FontSize="14" 
                                      HorizontalAlignment="Center" 
                                      Foreground="{DynamicResource MaterialDesignValidationSuccessBrush}"/>
                            <TextBlock Text="État Système" FontSize="12" Opacity="0.6" HorizontalAlignment="Center"/>
                        </StackPanel>
                    </materialDesign:Card>
                    
                    <!-- Temps de fonctionnement -->
                    <materialDesign:Card Style="{StaticResource DiagnosticCardStyle}">
                        <StackPanel HorizontalAlignment="Center">
                            <materialDesign:PackIcon Kind="Clock" Width="32" Height="32" 
                                                   Foreground="{DynamicResource PrimaryHueMidBrush}" Margin="0,0,0,8"/>
                            <TextBlock Text="{Binding SystemUptime}" FontWeight="Bold" FontSize="14" 
                                      HorizontalAlignment="Center"/>
                            <TextBlock Text="Temps de fonctionnement" FontSize="12" Opacity="0.6" HorizontalAlignment="Center"/>
                        </StackPanel>
                    </materialDesign:Card>
                    
                    <!-- Nombre de logs -->
                    <materialDesign:Card Style="{StaticResource DiagnosticCardStyle}">
                        <StackPanel HorizontalAlignment="Center">
                            <materialDesign:PackIcon Kind="FileMultiple" Width="32" Height="32" 
                                                   Foreground="{DynamicResource SecondaryHueMidBrush}" Margin="0,0,0,8"/>
                            <TextBlock Text="{Binding Logs.Count}" FontWeight="Bold" FontSize="14" 
                                      HorizontalAlignment="Center"/>
                            <TextBlock Text="Entrées de logs" FontSize="12" Opacity="0.6" HorizontalAlignment="Center"/>
                        </StackPanel>
                    </materialDesign:Card>
                    
                    <!-- CPU Usage -->
                    <materialDesign:Card Style="{StaticResource DiagnosticCardStyle}">
                        <StackPanel HorizontalAlignment="Center">
                            <materialDesign:PackIcon Kind="Memory" Width="32" Height="32" 
                                                   Foreground="{DynamicResource MaterialDesignValidationErrorBrush}" Margin="0,0,0,8"/>
                            <TextBlock Text="{Binding CpuUsage}" FontWeight="Bold" FontSize="14" 
                                      HorizontalAlignment="Center"/>
                            <TextBlock Text="Utilisation CPU" FontSize="12" Opacity="0.6" HorizontalAlignment="Center"/>
                        </StackPanel>
                    </materialDesign:Card>
                </UniformGrid>
                
                <!-- Barre de contrôle modernisée -->
                <Grid Grid.Row="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- Filtres de niveau avec design moderne -->
                    <materialDesign:Card Grid.Column="0" Padding="16" Margin="0,0,16,0"
                                       Background="{DynamicResource MaterialDesignBackground}">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="Filter" Width="20" Height="20" 
                                                   VerticalAlignment="Center" Margin="0,0,12,0"
                                                   Foreground="{DynamicResource PrimaryHueMidBrush}"/>
                            <TextBlock Text="Filtres :" VerticalAlignment="Center" Margin="0,0,16,0" 
                                     FontWeight="Medium" Foreground="{DynamicResource MaterialDesignBody}"/>
                            
                            <CheckBox Content="🐛 Debug" IsChecked="{Binding IsDebugEnabled}" 
                                    Command="{Binding FilterLogsCommand}" Margin="0,0,16,0"
                                    Foreground="{DynamicResource MaterialDesignBodyLight}"/>
                            <CheckBox Content="ℹ️ Info" IsChecked="{Binding IsInfoEnabled}" 
                                    Command="{Binding FilterLogsCommand}" Margin="0,0,16,0"
                                    Foreground="{DynamicResource MaterialDesignBodyLight}"/>
                            <CheckBox Content="⚠️ Warning" IsChecked="{Binding IsWarningEnabled}" 
                                    Command="{Binding FilterLogsCommand}" Margin="0,0,16,0"
                                    Foreground="{DynamicResource MaterialDesignBodyLight}"/>
                            <CheckBox Content="❌ Error" IsChecked="{Binding IsErrorEnabled}" 
                                    Command="{Binding FilterLogsCommand}"
                                    Foreground="{DynamicResource MaterialDesignBodyLight}"/>
                        </StackPanel>
                    </materialDesign:Card>
                    
                    <!-- Boutons d'action groupés -->
                    <StackPanel Grid.Column="1" Orientation="Horizontal">
                        <Button Style="{StaticResource SecondaryButtonStyle}"
                                ToolTip="Générer des logs de test pour la démonstration"
                                Command="{Binding GenerateTestLogsCommand}">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="TestTube" Width="16" Height="16" Margin="0,0,6,0"/>
                                <TextBlock Text="Test"/>
                            </StackPanel>
                        </Button>
                        
                        <Button Style="{StaticResource SecondaryButtonStyle}"
                                ToolTip="Exporter tous les logs vers un fichier"
                                Command="{Binding ExportLogsCommand}">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="Export" Width="16" Height="16" Margin="0,0,6,0"/>
                                <TextBlock Text="Export"/>
                            </StackPanel>
                        </Button>
                        
                        <Button Style="{StaticResource SecondaryButtonStyle}"
                                ToolTip="Effacer tous les logs (attention: irréversible)"
                                Command="{Binding ClearLogsCommand}">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="Delete" Width="16" Height="16" Margin="0,0,6,0"/>
                                <TextBlock Text="Vider"/>
                            </StackPanel>
                        </Button>
                        
                        <Button Style="{StaticResource ActionButtonStyle}"
                                ToolTip="Lancer un diagnostic système complet"
                                Command="{Binding RunDiagnosticsCommand}">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="Magnify" Width="16" Height="16" Margin="0,0,8,0"/>
                                <TextBlock Text="Diagnostic"/>
                            </StackPanel>
                        </Button>
                    </StackPanel>
                </Grid>
            </Grid>
        </materialDesign:Card>

        <!-- Zone d'affichage des logs avec TabControl moderne -->
        <Grid Grid.Row="2">
            <materialDesign:Card Padding="0" ClipToBounds="True">
                <TabControl x:Name="LogsTabControl" 
                          Style="{StaticResource MaterialDesignTabControl}"
                          materialDesign:ColorZoneAssist.Mode="PrimaryMid"
                          Background="{DynamicResource MaterialDesignBackground}">
                    
                    <!-- Onglet Logs en temps réel -->
                    <TabItem Header="📋 Logs Temps Réel">
                        <TabItem.HeaderTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <materialDesign:PackIcon Kind="FileTextOutline" Width="16" Height="16" Margin="0,0,8,0"/>
                                    <TextBlock Text="Logs Temps Réel" FontWeight="Medium"/>
                                </StackPanel>
                            </DataTemplate>
                        </TabItem.HeaderTemplate>
                        
                        <Grid Margin="16">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            
                            <!-- Indicateur d'activité -->
                            <Border Grid.Row="0" Background="{DynamicResource MaterialDesignSelection}" 
                                  CornerRadius="4" Padding="12,8" Margin="0,0,0,16">
                                <StackPanel Orientation="Horizontal">
                                    <Ellipse Width="8" Height="8" Fill="{DynamicResource MaterialDesignValidationSuccessBrush}">
                                        <Ellipse.Style>
                                            <Style TargetType="Ellipse">
                                                <Setter Property="Opacity" Value="0.3"/>
                                                <Style.Triggers>
                                                    <EventTrigger RoutedEvent="Loaded">
                                                        <BeginStoryboard>
                                                            <Storyboard RepeatBehavior="Forever">
                                                                <DoubleAnimation Storyboard.TargetProperty="Opacity" 
                                                                               From="0.3" To="1" Duration="0:0:1" 
                                                                               AutoReverse="True"/>
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </EventTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Ellipse.Style>
                                    </Ellipse>
                                    <TextBlock Text="Écoute active des logs système" Margin="8,0,0,0" 
                                             FontWeight="Medium" FontSize="12"/>
                                </StackPanel>
                            </Border>
                            
                            <!-- Liste des logs modernisée -->
                            <Border Grid.Row="1" BorderBrush="{DynamicResource MaterialDesignDivider}" 
                                  BorderThickness="1" CornerRadius="4">
                                <ListView ItemsSource="{Binding Logs}" 
                                        ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                        VirtualizingPanel.IsVirtualizing="True"
                                        VirtualizingPanel.VirtualizationMode="Recycling"
                                        Background="Transparent">
                                    
                                    <ListView.ItemContainerStyle>
                                        <Style TargetType="ListViewItem" BasedOn="{StaticResource MaterialDesignListBoxItem}">
                                            <Setter Property="Padding" Value="8"/>
                                            <Setter Property="Margin" Value="0,0,0,1"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Level}" Value="Error">
                                                    <Setter Property="Background" Value="{DynamicResource MaterialDesignValidationErrorBackground}"/>
                                                    <Setter Property="BorderBrush" Value="{DynamicResource MaterialDesignValidationErrorBrush}"/>
                                                    <Setter Property="BorderThickness" Value="0,0,4,0"/>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding Level}" Value="Warning">
                                                    <Setter Property="Background" Value="#FFF3E0"/>
                                                    <Setter Property="BorderBrush" Value="#FF9800"/>
                                                    <Setter Property="BorderThickness" Value="0,0,4,0"/>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding Level}" Value="Debug">
                                                    <Setter Property="Background" Value="#F3E5F5"/>
                                                    <Setter Property="BorderBrush" Value="#9C27B0"/>
                                                    <Setter Property="BorderThickness" Value="0,0,4,0"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </ListView.ItemContainerStyle>
                                    
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                
                                                <!-- Icône de niveau -->
                                                <Border Grid.Column="0" Width="32" Height="32" 
                                                      CornerRadius="16" VerticalAlignment="Top" Margin="0,0,12,0">
                                                    <Border.Style>
                                                        <Style TargetType="Border">
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Level}" Value="Error">
                                                                    <Setter Property="Background" Value="{DynamicResource MaterialDesignValidationErrorBrush}"/>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding Level}" Value="Warning">
                                                                    <Setter Property="Background" Value="#FF9800"/>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding Level}" Value="Info">
                                                                    <Setter Property="Background" Value="{DynamicResource PrimaryHueMidBrush}"/>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding Level}" Value="Debug">
                                                                    <Setter Property="Background" Value="#9C27B0"/>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Border.Style>
                                                    
                                                    <materialDesign:PackIcon Width="16" Height="16" 
                                                                           Foreground="White"
                                                                           HorizontalAlignment="Center" 
                                                                           VerticalAlignment="Center">
                                                        <materialDesign:PackIcon.Style>
                                                            <Style TargetType="materialDesign:PackIcon">
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding Level}" Value="Error">
                                                                        <Setter Property="Kind" Value="AlertCircle"/>
                                                                    </DataTrigger>
                                                                    <DataTrigger Binding="{Binding Level}" Value="Warning">
                                                                        <Setter Property="Kind" Value="Alert"/>
                                                                    </DataTrigger>
                                                                    <DataTrigger Binding="{Binding Level}" Value="Info">
                                                                        <Setter Property="Kind" Value="Information"/>
                                                                    </DataTrigger>
                                                                    <DataTrigger Binding="{Binding Level}" Value="Debug">
                                                                        <Setter Property="Kind" Value="Bug"/>
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </materialDesign:PackIcon.Style>
                                                    </materialDesign:PackIcon>
                                                </Border>
                                                
                                                <!-- Timestamp -->
                                                <TextBlock Grid.Column="1" Text="{Binding Timestamp, StringFormat=HH:mm:ss}" 
                                                         FontFamily="Consolas" FontSize="11" 
                                                         Foreground="{DynamicResource MaterialDesignBodyLight}"
                                                         VerticalAlignment="Top" Margin="0,2,12,0" MinWidth="60"/>
                                                
                                                <!-- Message -->
                                                <StackPanel Grid.Column="2">
                                                    <TextBlock Text="{Binding Message}" TextWrapping="Wrap" 
                                                             FontWeight="Medium" FontSize="13"/>
                                                    <TextBlock Text="{Binding Source}" Opacity="0.7" FontSize="11" 
                                                             Margin="0,2,0,0" Visibility="{Binding Source, Converter={StaticResource StringToVisibilityConverter}}"/>
                                                </StackPanel>
                                            </Grid>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                </ListView>
                            </Border>
                        </Grid>
                    </TabItem>
                    
                    <!-- Onglet Diagnostic Système -->
                    <TabItem Header="🔧 Diagnostic">
                        <TabItem.HeaderTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <materialDesign:PackIcon Kind="Wrench" Width="16" Height="16" Margin="0,0,8,0"/>
                                    <TextBlock Text="Diagnostic Système" FontWeight="Medium"/>
                                </StackPanel>
                            </DataTemplate>
                        </TabItem.HeaderTemplate>
                        
                        <ScrollViewer Margin="16">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <!-- Informations système -->
                                <materialDesign:Card Grid.Row="0" Padding="16" Margin="0,0,0,16">
                                    <Expander Header="📊 Informations Système" IsExpanded="True">
                                        <Grid Margin="0,16,0,0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            
                                            <StackPanel Grid.Column="0" Margin="0,0,16,0">
                                                <TextBlock Text="Général" FontWeight="Bold" Margin="0,0,0,8" 
                                                         Foreground="{DynamicResource PrimaryHueMidBrush}"/>
                                                <TextBlock>
                                                    <Run Text="OS : " FontWeight="Medium"/>
                                                    <Run Text="{Binding SystemInfo.OperatingSystem}"/>
                                                </TextBlock>
                                                <TextBlock>
                                                    <Run Text="Version .NET : " FontWeight="Medium"/>
                                                    <Run Text="{Binding SystemInfo.DotNetVersion}"/>
                                                </TextBlock>
                                                <TextBlock>
                                                    <Run Text="Architecture : " FontWeight="Medium"/>
                                                    <Run Text="{Binding SystemInfo.Architecture}"/>
                                                </TextBlock>
                                            </StackPanel>
                                            
                                            <StackPanel Grid.Column="1">
                                                <TextBlock Text="Performance" FontWeight="Bold" Margin="0,0,0,8" 
                                                         Foreground="{DynamicResource PrimaryHueMidBrush}"/>
                                                <TextBlock>
                                                    <Run Text="Mémoire totale : " FontWeight="Medium"/>
                                                    <Run Text="{Binding SystemInfo.TotalMemory}"/>
                                                </TextBlock>
                                                <TextBlock>
                                                    <Run Text="Mémoire disponible : " FontWeight="Medium"/>
                                                    <Run Text="{Binding SystemInfo.AvailableMemory}"/>
                                                </TextBlock>
                                                <TextBlock>
                                                    <Run Text="Processeurs : " FontWeight="Medium"/>
                                                    <Run Text="{Binding SystemInfo.ProcessorCount}"/>
                                                </TextBlock>
                                            </StackPanel>
                                        </Grid>
                                    </Expander>
                                </materialDesign:Card>
                                
                                <!-- État des composants -->
                                <materialDesign:Card Grid.Row="1" Padding="16" Margin="0,0,0,16">
                                    <Expander Header="🔍 État des Composants" IsExpanded="True">
                                        <ItemsControl ItemsSource="{Binding DiagnosticResults}" Margin="0,16,0,0">
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <Border Background="{DynamicResource MaterialDesignBackground}" 
                                                          BorderBrush="{DynamicResource MaterialDesignDivider}"
                                                          BorderThickness="1" CornerRadius="4" Padding="12" Margin="0,0,0,8">
                                                        <Grid>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="Auto"/>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            
                                                            <materialDesign:PackIcon Grid.Column="0" Width="20" Height="20" 
                                                                                   VerticalAlignment="Center" Margin="0,0,12,0">
                                                                <materialDesign:PackIcon.Style>
                                                                    <Style TargetType="materialDesign:PackIcon">
                                                                        <Style.Triggers>
                                                                            <DataTrigger Binding="{Binding IsHealthy}" Value="True">
                                                                                <Setter Property="Kind" Value="CheckCircle"/>
                                                                                <Setter Property="Foreground" Value="{DynamicResource MaterialDesignValidationSuccessBrush}"/>
                                                                            </DataTrigger>
                                                                            <DataTrigger Binding="{Binding IsHealthy}" Value="False">
                                                                                <Setter Property="Kind" Value="AlertCircle"/>
                                                                                <Setter Property="Foreground" Value="{DynamicResource MaterialDesignValidationErrorBrush}"/>
                                                                            </DataTrigger>
                                                                        </Style.Triggers>
                                                                    </Style>
                                                                </materialDesign:PackIcon.Style>
                                                            </materialDesign:PackIcon>
                                                            
                                                            <StackPanel Grid.Column="1">
                                                                <TextBlock Text="{Binding Component}" FontWeight="Medium"/>
                                                                <TextBlock Text="{Binding Message}" Opacity="0.7" FontSize="12"/>
                                                            </StackPanel>
                                                            
                                                            <TextBlock Grid.Column="2" Text="{Binding Status}" 
                                                                     VerticalAlignment="Center" FontWeight="Bold">
                                                                <TextBlock.Style>
                                                                    <Style TargetType="TextBlock">
                                                                        <Style.Triggers>
                                                                            <DataTrigger Binding="{Binding IsHealthy}" Value="True">
                                                                                <Setter Property="Foreground" Value="{DynamicResource MaterialDesignValidationSuccessBrush}"/>
                                                                            </DataTrigger>
                                                                            <DataTrigger Binding="{Binding IsHealthy}" Value="False">
                                                                                <Setter Property="Foreground" Value="{DynamicResource MaterialDesignValidationErrorBrush}"/>
                                                                            </DataTrigger>
                                                                        </Style.Triggers>
                                                                    </Style>
                                                                </TextBlock.Style>
                                                            </TextBlock>
                                                        </Grid>
                                                    </Border>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                    </Expander>
                                </materialDesign:Card>
                                
                                <!-- Bouton de rafraîchissement -->
                                <Button Grid.Row="2" Style="{StaticResource ActionButtonStyle}"
                                      HorizontalAlignment="Center" 
                                      Command="{Binding RefreshDiagnosticsCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <materialDesign:PackIcon Kind="Refresh" Width="16" Height="16" Margin="0,0,8,0"/>
                                        <TextBlock Text="Actualiser le Diagnostic"/>
                                    </StackPanel>
                                </Button>
                            </Grid>
                        </ScrollViewer>
                    </TabItem>
                </TabControl>
            </materialDesign:Card>
        </Grid>
    </Grid>
</UserControl>
